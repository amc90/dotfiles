#!/bin/sh

while true
do
	if [ `hostname` == "temperance" ]; then
		~/bin/LayoutUndock
	fi
	xscreensaver-command -exit
	xscreensaver -no-splash &
	killall gpg-agent
	eval `gpg-agent --daemon`
	START_TIME=`date +%s`
	wmii
	if test "$?" -eq "0"
	then
		exit 1
	fi

	if [ "$(expr "$START_TIME" + 3 )" -gt "$(date +%s)" ]
	then
		echo "WM exited too quickly" >&1
		exit 1
	fi
done
