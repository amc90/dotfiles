#!/bin/bash

TASK() {
	task rc.verbose=nothing rc.confirmation=off "$@"|
		grep -v '^Config file [-_./a-zA-Z0-9]* modified.$'
}

FILTER="$(
	task show 'context.'|
	#List every context filter
	sed -nE 's/^context\.[a-zA-Z0-9]*\.read +//p'|
	#Output as a negated expression
	awk 'BEGIN{printf "(!("}{printf "%s(%s)", (FNR==1?"":" or "), $1}END{print "))"}')"

TASK config report.nocontext.description 'Match anything not included in a context'
TASK config report.nocontext.filter       "$FILTER"
TASK config report.nocontext.context 0

TASK config report.nocontext.columns     'id,start.age,entry.age,depends.indicator,priority,project,tags,recur.indicator,scheduled.countdown,due,until.remaining,description.count,urgency'
TASK config report.nocontext.labels      'ID,Active,Age,D,P,Project,Tags,R,Sch,Due,Until,Description,Urg'
TASK config report.nocontext.sort        'start-,due+,project+,urgency-'

